{{/* Display author list. */}}

{{ if .Params.authors }}
  {{ range $index, $value := (.GetTerms "authors") }}
    {{- /* 核心判断逻辑 */ -}}
    {{- $is_superuser := .Page.Params.superuser | default false -}}
    
    {{- /* 只有在 content/authors/ 下真正存在文件夹和 _index.md 的人才有 .File 对象 */ -}}
    {{- $is_real_member := .File -}} 
    
    {{- if gt $index 0 }}, {{ end -}}
    
    {{- /* 样式逻辑：
         1. Superuser -> 加粗 
         2. 真实成员 -> 下划线
         3. 外部作者 -> 普通文本 
    */ -}}
    <span class="{{ if $is_superuser }}font-bold text-slate-900 dark:text-white{{ else if $is_real_member }}underline underline-offset-4 decoration-slate-800 dark:decoration-slate-200{{ end }}">
      {{- /* 恢复所有作者的链接 */ -}}
      <a href="{{.RelPermalink}}">{{- .LinkTitle -}}</a></span>

    {{- /* 3. Author Notes (信封/备注) 区域 */ -}}
    {{- if isset $.Params "author_notes" -}}
      {{- with (index $.Params.author_notes $index) -}}
        {{- $note_text := . -}}
        <span class="relative inline-block" x-data="{ tooltip: false }">
          <button
            @mouseenter="tooltip = true"
            @mouseleave="tooltip = false"
            @click="tooltip = !tooltip"
            class="author-notes text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-200 transition-colors cursor-help"
            type="button"
          >
            {{- if (or (eq $note_text "Corresponding Author") (eq $note_text "corresponding author")) -}}
              {{- /* 使用 sup 让信封图标像角标一样上浮 */ -}}
              <sup class="ml-0.5 text-[10px]">✉️</sup>
            {{- else -}}
              {{- /* 普通备注也稍微上浮一点，看起来更像引用 */ -}}
              <sup class="ml-0.5">
                <svg class="inline-block w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                </svg>
              </sup>
            {{- end -}}
          </button>
          
          {{/* Tooltip 弹出层保持不变 */}}
          <div
            x-show="tooltip"
            x-cloak
            class="absolute z-50 bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 text-[10px] text-white bg-gray-900 dark:bg-gray-700 rounded-lg shadow-lg whitespace-nowrap"
          >
            {{ $note_text }}
            <div class="absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900 dark:border-t-gray-700"></div>
          </div>
        </span>
      {{- end -}}
    {{- end -}}
  {{- end -}}
{{- end -}}